#include <stdio.h>
#include "xparameters.h"
#include "buttons.h"

volatile int *gpio0 = (int *)XPAR_AXI_GPIO_0_BASEADDR; // dir base buttons

void init_buttons()
{
	// Configurar 4 bits como entrada
	gpio0[1] = MASK_BUTTONS;
}

int check_button()
{
	int data;
	char btn = 0; // Default: no button pressed

	// Checks if any button is pressed
	if ((data = gpio0[0] & MASK_BUTTONS) != 0)
	{
		if ((data & 0x2) != 0) 		// Right
			btn = 1;
		else if ((data & 0x4) != 0) // Left
			btn = 3;
		else if ((data & 0x1) != 0) // Top
			btn = 2;
	}

	return btn;
}

void wait_button()
{
	int data;
	while ((data = gpio0[0] & MASK_BUTTONS) != 0)
		msleep(10);
}
